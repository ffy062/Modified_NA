I = [1 0 0 0 0 0 0 0 0]';

G = [3 -1 0 -1 0 0 0 0 0;
    -1 3 -1 0 -1 0 0 0 0;
    0 -1 2 0 0 -1 0 0 0;
    -1 0 0 3 -1 0 -1 0 0;
    0 -1 0 -1 4 -1 0 -1 0;
    0 0 -1 0 -1 3 0 0 -1;
    0 0 0 -1 0 0 3 -1 0;
    0 0 0 0 -1 0 -1 4 -1;
    0 0 0 0 0 -1 0 -1 3;];
V =  G \ I;
V(6)

G = zeros(420 ,420);
I = zeros(420, 1);
I(1, 1) = 5;
for i = 1:420
    G(i, i) = 4;
    l = i - 1;
    r = i + 1;
    u = i - 21;
    d = i + 21;
    if(mod(i, 21) ~= 1)
        G(i, l) = -1;
        G(l, i) = -1;
    end
    if(mod(i, 21) ~= 0)
        G(i, r) = -1;
        G(r, i) = -1;
    end
    if(i > 21)
        G(i, u) = -1;
        G(u, i) = -1;
    end
    if(i < 400)
        G(i, d) = -1;
        G(d, i) = -1;
    end
end

for i = 1:21
    G(i, i) = 3;
    G(399 + i, 399 + i) = 3;
end
for i = 1:20
    G(1 + 21*(i-1), 1 + 21*(i-1)) = 3;
    G(21 + 21*(i-1), 21 + 21*(i-1)) = 3;
end
G(21, 21) = 2;

V = G\I;
disp("3c: ")
disp(V(84));

